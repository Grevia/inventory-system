<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>庫存管理系統</title>
    <link rel="stylesheet" href="styles.css">
    <script src="https://apis.google.com/js/api.js"></script>
    <script src="config.js"></script>
</head>
<body>
    <!-- 登入頁面 -->
    <div id="loginPage" class="page active">
        <div class="login-container">
            <h1>庫存管理系統</h1>
            <div class="login-form">
                <h2>員工登入</h2>
                <div class="input-group">
                    <label for="employeeId">員工編號：</label>
                    <input type="text" id="employeeId" placeholder="請輸入員工編號" maxlength="10">
                </div>
                <div class="login-buttons">
                    <button id="loginBtn" class="btn-primary" onclick="handleLogin()">登入</button>
                    <button id="employeeEditBtn" class="btn-secondary" onclick="showAdminAuth()">員工資料編輯</button>
                </div>
            </div>
        </div>
    </div>

    <!-- 管理員驗證頁面 -->
    <div id="adminAuthPage" class="page">
        <div class="login-container">
            <h1>管理員驗證</h1>
            <div class="login-form">
                <h2>請輸入管理員帳號密碼</h2>
                <div class="input-group">
                    <label for="adminUsername">管理帳號：</label>
                    <input type="text" id="adminUsername" placeholder="請輸入管理帳號" maxlength="20">
                </div>
                <div class="input-group">
                    <label for="adminPassword">管理密碼：</label>
                    <input type="password" id="adminPassword" placeholder="請輸入管理密碼" maxlength="20">
                </div>
                <div class="login-buttons">
                    <button id="adminAuthBtn" class="btn-primary">驗證</button>
                    <button id="backToLoginBtn" class="btn-secondary">返回登入</button>
                </div>
            </div>
        </div>
    </div>

    <!-- 員工註冊頁面 -->
    <div id="employeeRegisterPage" class="page">
        <div class="header">
            <h1>員工資料註冊</h1>
            <div class="header-buttons">
                <button id="backToLoginFromRegisterBtn" class="btn-secondary">返回登入頁面</button>
                <button id="backToAdminBtn" class="btn-secondary">返回管理員驗證</button>
            </div>
        </div>
        
        <div class="register-container">
            <!-- 註冊表單區域 -->
            <div class="register-form">
                <h3>請填寫員工資料</h3>
                <div class="input-group">
                    <label for="employeeName">姓名：</label>
                    <input type="text" id="employeeName" placeholder="請輸入姓名" maxlength="50" required>
                </div>
                <div class="input-group">
                    <label for="employeePhone">電話：</label>
                    <input type="tel" id="employeePhone" placeholder="請輸入電話號碼" maxlength="20" required>
                </div>
                <div class="input-group">
                    <label for="employeeEmail">Email：</label>
                    <input type="email" id="employeeEmail" placeholder="請輸入Email" maxlength="100" required>
                </div>
                <div class="register-info">
                    <p><strong>註冊後將自動產生員工編號：</strong></p>
                    <div id="generatedEmployeeId" class="generated-id">GR00001</div>
                </div>
                <div class="register-buttons">
                    <button id="registerEmployeeBtn" class="btn-primary">註冊員工</button>
                    <button id="clearRegisterBtn" class="btn-secondary">清除資料</button>
                </div>
            </div>
            
            <!-- 員工清單區域 -->
            <div class="employee-list-section">
                <h3>員工清單</h3>
                <div class="employee-list-controls">
                    <button id="refreshEmployeeListBtn" class="btn-secondary">重新整理清單</button>
                    <button id="saveEmployeeStatusBtn" class="btn-primary">儲存狀態變更</button>
                </div>
                <div class="employee-list-container">
                    <table id="employeeListTable" class="employee-table">
                        <thead>
                            <tr>
                                <th>員工編號</th>
                                <th>姓名</th>
                                <th>電話</th>
                                <th>Email</th>
                                <th>註冊日期</th>
                                <th>狀態</th>
                            </tr>
                        </thead>
                        <tbody id="employeeListBody">
                            <!-- 員工資料將在這裡動態載入 -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <!-- 功能頁面 -->
    <div id="functionPage" class="page">
        <div class="header">
            <h1>功能選單</h1>
            <div class="user-info">
                <span id="currentUser"></span>
                <button id="logoutBtn" class="btn-secondary">登出</button>
            </div>
        </div>
        <div class="function-grid">
            <div class="function-card" onclick="navigateToReceiving()">
                <div class="card-icon">📦</div>
                <h3>點到貨</h3>
                <p>處理貨物接收</p>
            </div>
            <div class="function-card" onclick="navigateToImport()">
                <div class="card-icon">📥</div>
                <h3>匯入採購到貨</h3>
                <p>從Google Sheets匯入資料</p>
            </div>
            <div class="function-card" onclick="navigateToShipping()">
                <div class="card-icon">🚚</div>
                <h3>出貨表</h3>
                <p>管理出貨記錄</p>
            </div>
            <div class="function-card" onclick="navigateToUnboxing()">
                <div class="card-icon">📦</div>
                <h3>開箱明細</h3>
                <p>記錄開箱資訊</p>
            </div>
            <div class="function-card disabled">
                <div class="card-icon">🔍</div>
                <h3>功能4</h3>
                <p>待開發</p>
            </div>
            <div class="function-card disabled">
                <div class="card-icon">📈</div>
                <h3>功能5</h3>
                <p>待開發</p>
            </div>
            <div class="function-card disabled">
                <div class="card-icon">⚙️</div>
                <h3>功能6</h3>
                <p>待開發</p>
            </div>
            <div class="function-card disabled">
                <div class="card-icon">📱</div>
                <h3>功能7</h3>
                <p>待開發</p>
            </div>
            <div class="function-card disabled">
                <div class="card-icon">🔧</div>
                <h3>功能8</h3>
                <p>待開發</p>
            </div>
            <div class="function-card disabled">
                <div class="card-icon">📞</div>
                <h3>功能9</h3>
                <p>待開發</p>
            </div>
        </div>
    </div>

    <!-- 點到貨頁面 -->
    <div id="receivingPage" class="page">
        <div class="header">
            <h1>點到貨系統</h1>
            <button id="backToFunctionBtn" class="btn-secondary">回功能頁面</button>
        </div>
        
        <div class="receiving-container">
            <!-- 採購單號輸入區域 -->
            <div class="po-input-section">
                <div class="input-group">
                    <label for="poNumber">採購單號：</label>
                    <input type="text" id="poNumber" placeholder="請輸入採購單號" maxlength="20">
                    <button id="searchPoBtn" class="btn-primary">查詢</button>
                </div>
            </div>

            <!-- 統計結果顯示 -->
            <div class="statistics-section">
                <div class="stat-card">
                    <h3>符合筆數</h3>
                    <div id="matchCount" class="stat-number">0</div>
                    <p>筆符合的採購單</p>
                </div>
                <div class="stat-card">
                    <h3>到貨總數</h3>
                    <div id="totalQuantity" class="stat-number">0</div>
                    <p>件商品</p>
                </div>
            </div>

            <!-- 序號輸入區域 -->
            <div class="serial-input-section">
                <h3>序號輸入</h3>
                
                <!-- 刷到貨比數統計 -->
                <div class="scan-count-section">
                    <div class="scan-count-card">
                        <h4>刷到貨比數</h4>
                        <div id="scanCount" class="scan-count-number">0</div>
                        <p>筆已掃描</p>
                    </div>
                </div>
                
                <div class="serial-grid">
                    <div class="serial-input-group">
                        <label>序號 1：</label>
                        <input type="text" class="serial-input" data-index="1" placeholder="請輸入或掃描序號">
                    </div>
                    <div class="serial-input-group">
                        <label>序號 2：</label>
                        <input type="text" class="serial-input" data-index="2" placeholder="請輸入或掃描序號">
                    </div>
                    <div class="serial-input-group">
                        <label>序號 3：</label>
                        <input type="text" class="serial-input" data-index="3" placeholder="請輸入或掃描序號">
                    </div>
                    <div class="serial-input-group">
                        <label>序號 4：</label>
                        <input type="text" class="serial-input" data-index="4" placeholder="請輸入或掃描序號">
                    </div>
                    <div class="serial-input-group">
                        <label>序號 5：</label>
                        <input type="text" class="serial-input" data-index="5" placeholder="請輸入或掃描序號">
                    </div>
                    <div class="serial-input-group">
                        <label>序號 6：</label>
                        <input type="text" class="serial-input" data-index="6" placeholder="請輸入或掃描序號">
                    </div>
                    <div class="serial-input-group">
                        <label>序號 7：</label>
                        <input type="text" class="serial-input" data-index="7" placeholder="請輸入或掃描序號">
                    </div>
                    <div class="serial-input-group">
                        <label>序號 8：</label>
                        <input type="text" class="serial-input" data-index="8" placeholder="請輸入或掃描序號">
                    </div>
                    <div class="serial-input-group">
                        <label>序號 9：</label>
                        <input type="text" class="serial-input" data-index="9" placeholder="請輸入或掃描序號">
                    </div>
                    <div class="serial-input-group">
                        <label>序號 10：</label>
                        <input type="text" class="serial-input" data-index="10" placeholder="請輸入或掃描序號">
                    </div>
                </div>
                <div class="action-buttons">
                    <button id="submitBtn" class="btn-primary">提交資料</button>
                    <button id="clearBtn" class="btn-secondary">清除所有</button>
                </div>
            </div>
        </div>
    </div>

    <!-- 匯入採購到貨頁面 -->
    <div id="importPage" class="page">
        <div class="header">
            <h1>匯入採購到貨</h1>
            <button id="backToFunctionFromImportBtn" class="btn-secondary">回功能頁面</button>
        </div>
        
        <div class="import-container">
            <!-- Google Sheets 設定 -->
            <div class="sheets-config-section">
                <h3>Google Sheets 設定</h3>
                <div class="input-group">
                    <label for="sheetsUrl">Google Sheets URL：</label>
                    <input type="text" id="sheetsUrl" placeholder="請輸入Google Sheets URL" value="https://docs.google.com/spreadsheets/d/1wJLOHKOrT06CMpuY9X37FhXdQBRCU_gv2KCvJBkMC4k/edit?gid=1971479845#gid=1971479845">
                </div>
                <div class="input-group">
                    <label for="sheetName">工作表名稱：</label>
                    <input type="text" id="sheetName" placeholder="請輸入工作表名稱" value="採購明細">
                </div>
                <div class="input-group">
                    <label>認證方式：</label>
                    <span style="color: #007bff; font-weight: bold;">🌐 公開讀取模式</span>
                </div>
                <div class="input-group">
                    <label>設定說明：</label>
                    <span style="color: #666; font-size: 14px;">請確保Google Sheets已設定為「任何人都可以查看」</span>
                </div>
                <button id="testConnectionBtn" class="btn-primary">測試連線</button>
            </div>

            <!-- 資料預覽 -->
            <div class="data-preview-section">
                <h3>資料預覽</h3>
                <div class="preview-controls">
                    <button id="loadDataBtn" class="btn-primary">載入資料</button>
                    <button id="refreshDataBtn" class="btn-secondary">重新整理</button>
                    <span id="dataCount" class="data-count">0 筆資料</span>
                </div>
                <div class="table-container">
                    <table id="dataTable" class="data-table">
                        <tbody id="dataTableBody">
                            <!-- 資料會動態載入，包括表頭 -->
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- 匯入控制 -->
            <div class="import-controls-section">
                <h3>匯入控制</h3>
                <div class="control-group">
                    <label>
                        <input type="checkbox" id="selectAll" onchange="toggleSelectAll()">
                        全選
                    </label>
                    <button id="importSelectedBtn" class="btn-primary">匯入選取項目</button>
                    <button id="clearSelectionBtn" class="btn-secondary">清除選擇</button>
                </div>
                <div class="import-status">
                    <div id="importProgress" class="progress-bar hidden">
                        <div class="progress-fill"></div>
                    </div>
                    <div id="importStatus" class="status-text"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- 出貨表頁面 -->
    <div id="shippingPage" class="page">
        <div class="header">
            <h1>出貨表管理</h1>
            <button id="backToFunctionFromShippingBtn" class="btn-secondary">回功能頁面</button>
        </div>
        
        <div class="shipping-container">
            <!-- 新增出貨記錄 -->
            <div class="shipping-form-section">
                <h3>新增出貨記錄</h3>
                <div class="shipping-form">
                    <div class="form-row">
                        <div class="input-group">
                            <label for="shippingDate">出庫日期：</label>
                            <input type="date" id="shippingDate" required>
                        </div>
                        <div class="input-group">
                            <label for="shippingPrice">出貨價格：</label>
                            <input type="number" id="shippingPrice" placeholder="請輸入價格" min="0" step="0.01" required>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="input-group">
                            <label for="paymentMethod">付款方式：</label>
                            <select id="paymentMethod" required>
                                <option value="">請選擇付款方式</option>
                                <option value="現金">現金</option>
                                <option value="信用卡">信用卡</option>
                                <option value="轉帳">轉帳</option>
                                <option value="支票">支票</option>
                                <option value="其他">其他</option>
                            </select>
                        </div>
                        <div class="input-group">
                            <label for="orderNumber">訂單編號：</label>
                            <input type="text" id="orderNumber" placeholder="請輸入訂單編號" maxlength="50" required>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="input-group">
                            <label for="shippingTarget">出貨對象：</label>
                            <input type="text" id="shippingTarget" placeholder="請輸入出貨對象" maxlength="100" required>
                        </div>
                        <div class="input-group">
                            <label for="shippingPerson">出貨人員：</label>
                            <input type="text" id="shippingPerson" placeholder="自動填入登入員工編號" maxlength="50" required readonly>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="input-group full-width">
                            <label for="shippingNotes">備註：</label>
                            <textarea id="shippingNotes" placeholder="請輸入備註（選填）" rows="3" maxlength="500"></textarea>
                        </div>
                    </div>
                    <div class="shipping-form-buttons">
                        <button id="addShippingBtn" class="btn-primary">新增出貨記錄</button>
                        <button id="clearShippingFormBtn" class="btn-secondary">清除資料</button>
                    </div>
                </div>
            </div>
            
            <!-- 出貨記錄清單 -->
            <div class="shipping-list-section">
                <h3>出貨記錄清單</h3>
                <div class="shipping-list-controls">
                    <button id="refreshShippingListBtn" class="btn-secondary">重新整理清單</button>
                    <button id="exportShippingBtn" class="btn-primary">匯出Excel</button>
                    <button id="clearAllShippingBtn" class="btn-secondary">清除所有記錄</button>
                </div>
                <div class="shipping-list-container">
                    <table id="shippingListTable" class="shipping-table">
                        <thead>
                            <tr>
                                <th>出庫日期</th>
                                <th>出貨價格</th>
                                <th>付款方式</th>
                                <th>訂單編號</th>
                                <th>出貨對象</th>
                                <th>出貨人員</th>
                                <th>備註</th>
                                <th>操作</th>
                            </tr>
                        </thead>
                        <tbody id="shippingListBody">
                            <!-- 出貨記錄將在這裡動態載入 -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <!-- 開箱明細頁面 -->
    <div id="unboxingPage" class="page">
        <div class="header">
            <h1>開箱明細</h1>
            <button id="backToFunctionFromUnboxingBtn" class="btn-secondary">回功能頁面</button>
        </div>
        
        <div class="unboxing-container">
            <!-- 第一區塊：查詢採購單號 -->
            <div class="unboxing-search-section">
                <h3>查詢採購單號</h3>
                <div class="search-form">
                    <div class="input-group">
                        <label for="unboxingPoNumber">採購單號：</label>
                        <input type="text" id="unboxingPoNumber" placeholder="請輸入採購單號" maxlength="20">
                        <button id="searchUnboxingPoBtn" class="btn-primary">查詢</button>
                    </div>
                </div>
            </div>
            
            <!-- 第二區塊：開箱明細表單 -->
            <div class="unboxing-form-section">
                <h3>開箱明細記錄</h3>
                <div class="unboxing-info">
                    <div class="info-row">
                        <div class="info-item">
                            <label>採購單號：</label>
                            <span id="currentPoNumber">-</span>
                        </div>
                        <div class="info-item">
                            <label>進貨廠商：</label>
                            <span id="supplierName">-</span>
                        </div>
                        <div class="info-item">
                            <label>開箱人員：</label>
                            <span id="unboxingPerson">-</span>
                        </div>
                        <div class="info-item">
                            <label>開箱日期：</label>
                            <span id="unboxingDate">-</span>
                        </div>
                        <div class="info-item">
                            <label>需開箱數量：</label>
                            <span id="requiredUnboxingCount">-</span>
                        </div>
                    </div>
                </div>
                
                <div class="unboxing-items-section">
                    <h4>商品明細（共20項）</h4>
                    <div class="unboxing-items-container">
                        <table id="unboxingItemsTable" class="unboxing-table">
                            <thead>
                                <tr>
                                    <th>項目</th>
                                    <th>商品分類</th>
                                    <th>商品序號</th>
                                    <th>批號（自動派發流水號）</th>
                                </tr>
                            </thead>
                            <tbody id="unboxingItemsBody">
                                <!-- 20個商品項目將在這裡動態生成 -->
                            </tbody>
                        </table>
                    </div>
                </div>
                
                <div class="unboxing-form-buttons">
                    <button id="submitUnboxingBtn" class="btn-primary">上傳開箱明細</button>
                    <button id="clearUnboxingFormBtn" class="btn-secondary">清除資料</button>
                </div>
            </div>
        </div>
    </div>

    <!-- 管理員驗證頁面 -->
    <div id="adminAuthPage" class="page">
        <div class="header">
            <h1>管理員驗證</h1>
            <button id="backToLoginBtn" class="btn-secondary">返回登入</button>
        </div>
        
        <div class="admin-auth-container">
            <div class="auth-form">
                <h3>請輸入管理員帳號密碼</h3>
                <div class="input-group">
                    <label for="adminUsername">管理員帳號：</label>
                    <input type="text" id="adminUsername" placeholder="請輸入管理員帳號" required>
                </div>
                <div class="input-group">
                    <label for="adminPassword">管理員密碼：</label>
                    <input type="password" id="adminPassword" placeholder="請輸入管理員密碼" required>
                </div>
                <div class="auth-buttons">
                    <button id="adminAuthBtn" class="btn-primary">驗證</button>
                </div>
            </div>
        </div>
    </div>

    <!-- 員工註冊頁面 -->
    <div id="employeeRegisterPage" class="page">
        <div class="header">
            <h1>員工資料管理</h1>
            <button id="backToAdminBtn" class="btn-secondary">返回管理員驗證</button>
        </div>
        
        <div class="employee-register-container">
            <!-- 員工註冊表單 -->
            <div class="register-form-section">
                <h3>新增員工</h3>
                <div class="register-form">
                    <div class="input-group">
                        <label for="generatedEmployeeId">員工編號：</label>
                        <span id="generatedEmployeeId" class="generated-id">GR00001</span>
                    </div>
                    <div class="input-group">
                        <label for="employeeName">姓名：</label>
                        <input type="text" id="employeeName" placeholder="請輸入姓名" required>
                    </div>
                    <div class="input-group">
                        <label for="employeePhone">電話：</label>
                        <input type="tel" id="employeePhone" placeholder="請輸入電話號碼" required>
                    </div>
                    <div class="input-group">
                        <label for="employeeEmail">Email：</label>
                        <input type="email" id="employeeEmail" placeholder="請輸入Email" required>
                    </div>
                    <div class="register-buttons">
                        <button id="registerEmployeeBtn" class="btn-primary">註冊員工</button>
                        <button id="clearRegisterBtn" class="btn-secondary">清除資料</button>
                    </div>
                </div>
            </div>
            
            <!-- 員工清單 -->
            <div class="employee-list-section">
                <h3>員工清單</h3>
                <div class="employee-list-controls">
                    <button id="refreshEmployeeListBtn" class="btn-secondary">重新整理清單</button>
                    <button id="saveEmployeeStatusBtn" class="btn-primary">儲存狀態變更</button>
                    <button id="exportEmployeesBtn" class="btn-primary">匯出員工資料</button>
                    <button id="importEmployeesBtn" class="btn-secondary">匯入員工資料</button>
                    <input type="file" id="importEmployeesFile" accept=".json" style="display: none;">
                </div>
                <div class="employee-list-container">
                    <table id="employeeListTable" class="employee-table">
                        <thead>
                            <tr>
                                <th>員工編號</th>
                                <th>姓名</th>
                                <th>電話</th>
                                <th>Email</th>
                                <th>註冊日期</th>
                                <th>狀態</th>
                            </tr>
                        </thead>
                        <tbody id="employeeListBody">
                            <!-- 員工資料將在這裡動態載入 -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <!-- 載入中提示 -->
    <div id="loadingOverlay" class="loading-overlay hidden">
        <div class="loading-spinner"></div>
        <p>處理中...</p>
    </div>

    <!-- 訊息提示 -->
    <div id="messageBox" class="message-box hidden">
        <div class="message-content">
            <span id="messageText"></span>
            <button id="messageCloseBtn" class="btn-secondary">確定</button>
        </div>
    </div>

    <script src="config.js"></script>
    <script src="script.js"></script>
</body>
</html> 